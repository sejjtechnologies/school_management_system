<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Enter Pupil Payment</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />

  <style>
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
      background: #f1f8e9;
      display: flex;
      flex-direction: column;
    }

    body {
      padding-top: 60px; /* Offset for fixed navbar */
      font-size: 0.95rem;
    }

    .navbar {
      height: 60px;
      background-color: #37474f;
    }

    .content-area {
      flex: 1 0 auto;        /* Take remaining space */
      overflow-y: auto;      /* Enable vertical scrolling */
      padding: 20px;
      padding-bottom: 120px; /* Space for footer + button */
    }

    footer {
      flex-shrink: 0;
    }

    .card {
      width: 100%;
      max-width: 500px; /* Keep content centered and mobile-friendly */
      margin: 0 auto 20px auto;
    }

    @media (max-width: 576px) {
      .content-area {
        padding: 15px;
        padding-bottom: 140px; /* Extra space for footer on small screens */
      }

      .card-body input,
      .card-body select,
      .btn {
        font-size: 0.9rem;
      }
    }
  </style>
</head>
<body>

<!-- Fixed Top Navbar -->
<nav class="navbar fixed-top navbar-dark d-flex align-items-center px-3">
  <span class="navbar-brand mb-0 h5 text-white">
    <i class="bi bi-cash-coin"></i> Enter Payment
  </span>

  <a href="{{ url_for('bursar_routes.student_fees') }}" class="btn btn-warning btn-sm">
    Back
  </a>
</nav>

<div class="content-area container">

  <!-- Page Title -->
  <h3 class="mb-4 text-center fw-bold">
    Enter Payment for {{ pupil.first_name }} {{ pupil.last_name }}
  </h3>

  <!-- Card -->
  <div class="card shadow-lg border-0">
    <div class="card-body">

      <!-- Pupil Info -->
      <h5 class="fw-bold">Pupil Information</h5>
      <p class="mb-1"><strong>Admission No:</strong> {{ pupil.admission_number }}</p>
      <p class="mb-1"><strong>Class:</strong> {{ pupil.class_.name }}</p>
      <p class="mb-3"><strong>Stream:</strong> {{ pupil.stream.name if pupil.stream else "N/A" }}</p>

      <hr>

      <!-- Fees Summary -->
      <h5 class="fw-bold">Fees Summary</h5>
      <p><strong>Total Required:</strong> UGX {{ "{:,.0f}".format(pupil.total_required) }}</p>
      <p><strong>Total Paid:</strong> UGX {{ "{:,.0f}".format(pupil.total_paid) }}</p>
      <p><strong>Balance:</strong>
        <span class="text-danger fw-bold">UGX {{ "{:,.0f}".format(pupil.balance) }}</span>
      </p>

      <hr>

      <!-- Payment Form -->
      <form action="{{ url_for('bursar_routes.add_payment', pupil_id=pupil.id) }}" method="POST">

        <!-- Fee Item -->
        <div class="mb-3">
          <label class="form-label fw-bold">Select Fee Item</label>
          <select name="fee_id" class="form-select" required>
            <option value="">-- Choose Fee Item --</option>
            {% for item in pupil.class_fees %}
              <option value="{{ item.id }}">{{ item.item_name }} (UGX {{ "{:,.0f}".format(item.amount) }})</option>
            {% endfor %}
          </select>
        </div>

        <!-- Amount -->
        <div class="mb-3">
          <label class="form-label fw-bold">Amount Paid</label>
          <input type="number" name="amount_paid" class="form-control" min="100" required>
        </div>

        <!-- Payment Method -->
        <div class="mb-3">
          <label class="form-label fw-bold">Payment Method</label>
          <select name="payment_method" class="form-select" required>
            <option>Cash</option>
            <option>Mobile Money</option>
            <option>Bank Deposit</option>
            <option>Cheque</option>
          </select>
        </div>

        <button type="submit" class="btn btn-primary w-100 fw-bold">Save Payment</button>
      </form>

    </div>
  </div>

</div>

{% include 'footer.html' %}

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
